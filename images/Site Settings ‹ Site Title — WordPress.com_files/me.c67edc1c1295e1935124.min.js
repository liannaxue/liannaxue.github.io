webpackJsonp([28],{1424:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function(){if(_config2.default.isEnabled("me/my-profile")){(0,_page2.default)("/me",_controller2.default.sidebar,_controller2.default.profile);(0,_page2.default)("/me/profile",_controller2.default.profileRedirect);(0,_page2.default)("/me/public-profile",_controller2.default.profileRedirect)}if(_config2.default.isEnabled("me/next-steps")){(0,_page2.default)("/me/next/:welcome?",_controller2.default.sidebar,_controller2.default.nextStepsWelcomeRedirect,_controller2.default.nextSteps)}if(!_config2.default.isEnabled("me/trophies")){(0,_page2.default)("/me/trophies",_controller2.default.trophiesRedirect)}if(!_config2.default.isEnabled("me/find-friends")){(0,_page2.default)("/me/find-friends",_controller2.default.findFriendsRedirect)}(0,_page2.default)("/me/get-apps",_controller2.default.sidebar,_controller2.default.apps)};var _config=__webpack_require__(10);var _config2=_interopRequireDefault(_config);var _page=__webpack_require__(40);var _page2=_interopRequireDefault(_page);var _controller=__webpack_require__(1516);var _controller2=_interopRequireDefault(_controller);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}module.exports=exports["default"]},1454:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _i18nCalypso=__webpack_require__(13);var _sidebarNavigation=__webpack_require__(1586);var _sidebarNavigation2=_interopRequireDefault(_sidebarNavigation);var _gravatar=__webpack_require__(647);var _gravatar2=_interopRequireDefault(_gravatar);var _user=__webpack_require__(37);var _user2=_interopRequireDefault(_user);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var user=(0,_user2.default)();var MeSidebarNavigation=function MeSidebarNavigation(_ref){var translate=_ref.translate;return _react2.default.createElement(_sidebarNavigation2.default,{sectionName:"me",sectionTitle:translate("Me")},_react2.default.createElement(_gravatar2.default,{user:user.get(),size:30,imgSize:400}))};exports.default=(0,_i18nCalypso.localize)(MeSidebarNavigation);module.exports=exports["default"]},1464:function(module,exports,__webpack_require__){"use strict";var _stringify=__webpack_require__(41);var _stringify2=_interopRequireDefault(_stringify);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var debug=__webpack_require__(4)("calypso:two-step-authorization");var emitter=__webpack_require__(32),wpcom=__webpack_require__(22).undocumented(),userSettings=__webpack_require__(346),applicationPasswords=__webpack_require__(1503),connectedApplications=__webpack_require__(1504),profileLinks=__webpack_require__(1482),analytics=__webpack_require__(16);function TwoStepAuthorization(){if(!(this instanceof TwoStepAuthorization)){return new TwoStepAuthorization}this.data=null;this.initialized=false;this.indvalidCode=false;this.smsResendThrottled=false;this.bumpMCStat=function(eventAction){analytics.mc.bumpStat("2fa",eventAction)};this.fetch()}TwoStepAuthorization.prototype.fetch=function(callback){wpcom.me().getTwoStep(function(error,data){if(!error){this.data=data;if(this.isReauthRequired()&&this.isTwoStepSMSEnabled()&&!this.initialized){this.sendSMSCode()}if(this.isReauthRequired()&&!this.initialized){this.bumpMCStat("reauth-required")}this.initialized=true;this.emit("change")}if(callback){callback(error,data)}}.bind(this))};TwoStepAuthorization.prototype.validateCode=function(args,callback){wpcom.me().validateTwoStepCode(args,function(error,data){if(!error&&data.success){if(this.isReauthRequired()){userSettings.fetchSettings();applicationPasswords.fetch();connectedApplications.fetch();profileLinks.fetchProfileLinks()}this.data.two_step_reauthorization_required=false;this.data.two_step_authorization_expires_soon=false;this.invalidCode=false;if(args.action){this.bumpMCStat("enable-two-step"===args.action?"enable-2fa-successful":"disable-2fa-successful")}else{this.bumpMCStat("reauth-successful")}this.emit("change")}else if(!error){this.invalidCode=true;if(args.action){this.bumpMCStat("enable-two-step"===args.action?"enable-2fa-failed-invalid-code":"disable-2fa-failed-invalid-code")}else{this.bumpMCStat("reauth-failed-invalid-code")}}if(callback){callback(error,data)}}.bind(this))};TwoStepAuthorization.prototype.sendSMSCode=function(callback){wpcom.me().sendSMSValidationCode(function(error,data){if(error){debug("Sending SMS code failed: "+(0,_stringify2.default)(error));if(error.error&&"rate_limited"===error.error){debug("SMS resend throttled.");this.bumpMCStat("sms-code-send-throttled");this.smsResendThrottled=true}}else{this.smsResendThrottled=false;this.bumpMCStat("sms-code-send-success")}this.emit("change");if(callback){callback(error,data)}}.bind(this))};TwoStepAuthorization.prototype.backupCodes=function(callback){wpcom.me().backupCodes(function(error,data){if(error){debug("Fetching Backup Codes failed: "+(0,_stringify2.default)(error))}else{this.bumpMCStat("new-backup-codes-success")}if(callback){callback(error,data)}}.bind(this))};TwoStepAuthorization.prototype.validateBackupCode=function(code,callback){var args={code:code,action:"create-backup-receipt"};wpcom.me().validateTwoStepCode(args,function(error,data){if(error){debug("Validating Two Step Code failed: "+(0,_stringify2.default)(error))}if(data){this.bumpMCStat(data.success?"backup-code-validate-success":"backup-code-validate-failure")}if(callback){callback(error,data)}}.bind(this))};TwoStepAuthorization.prototype.getAppAuthCodes=function(callback){wpcom.me().getAppAuthCodes(function(error,data){if(error){debug("Getting App Auth Codes failed: "+(0,_stringify2.default)(error))}if(callback){callback(error,data)}})};TwoStepAuthorization.prototype.codeValidationFailed=function(){return this.invalidCode};TwoStepAuthorization.prototype.isSMSResendThrottled=function(){return this.smsResendThrottled};TwoStepAuthorization.prototype.isReauthRequired=function(){return this.data?this.data.two_step_reauthorization_required:false};TwoStepAuthorization.prototype.authExpiresSoon=function(){return this.data?this.data.two_step_authorization_expires_soon:false};TwoStepAuthorization.prototype.isTwoStepSMSEnabled=function(){return this.data?this.data.two_step_sms_enabled:false};TwoStepAuthorization.prototype.getSMSLastFour=function(){return this.data?this.data.two_step_sms_last_four:null};emitter(TwoStepAuthorization.prototype);module.exports=new TwoStepAuthorization},1476:function(module,exports,__webpack_require__){"use strict";var _stringify=__webpack_require__(41);var _stringify2=_interopRequireDefault(_stringify);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var React=__webpack_require__(1),LinkedStateMixin=__webpack_require__(340),debug=__webpack_require__(4)("calypso:me:reauth-required");var Dialog=__webpack_require__(148),FormFieldset=__webpack_require__(338),FormLabel=__webpack_require__(645),FormTelInput=__webpack_require__(1487),FormCheckbox=__webpack_require__(1463),FormButton=__webpack_require__(337),FormButtonsBar=__webpack_require__(654),FormInputValidation=__webpack_require__(1456),observe=__webpack_require__(146),Notice=__webpack_require__(79),eventRecorder=__webpack_require__(644),userUtilities=__webpack_require__(150),constants=__webpack_require__(1492);module.exports=React.createClass({displayName:"ReauthRequired",mixins:[LinkedStateMixin,observe("twoStepAuthorization"),eventRecorder],getInitialState:function getInitialState(){return{remember2fa:false,code:"",smsRequestsAllowed:true}},getCodeMessage:function getCodeMessage(){var codeMessage="";if(this.props.twoStepAuthorization.isTwoStepSMSEnabled()){codeMessage=this.translate("Please check your text messages at the phone number ending with {{strong}}%(smsLastFour)s{{/strong}} "+"and enter the verification code below.",{args:{smsLastFour:this.props.twoStepAuthorization.getSMSLastFour()},components:{strong:React.createElement("strong",null)}})}else{codeMessage=this.translate("Please enter the verification code generated by your Authenticator mobile application.")}return codeMessage},submitForm:function submitForm(event){event.preventDefault();this.setState({validatingCode:true});this.props.twoStepAuthorization.validateCode({code:this.state.code,remember2fa:this.state.remember2fa},function(error,data){this.setState({validatingCode:false});if(error){debug("There was an error validating that code: "+(0,_stringify2.default)(error))}else{debug("The code validated!"+(0,_stringify2.default)(data))}}.bind(this))},codeRequestTimer:false,allowSMSRequests:function allowSMSRequests(){this.setState({smsRequestsAllowed:true})},sendSMSCode:function sendSMSCode(){this.setState({smsRequestsAllowed:false});this.codeRequestTimer=setTimeout(this.allowSMSRequests,6e4);this.props.twoStepAuthorization.sendSMSCode(function(error,data){if(!error&&data.sent){debug("SMS code successfully sent")}else{debug("There was a failure sending the SMS code.")}})},preValidateAuthCode:function preValidateAuthCode(){return this.state.code.length&&this.state.code.length>5},renderSendSMSButton:function renderSendSMSButton(){var button;if(this.props.twoStepAuthorization.isTwoStepSMSEnabled()){button=React.createElement(FormButton,{disabled:!this.state.smsRequestsAllowed,isPrimary:false,onClick:this.recordClickEvent("Resend SMS Code Button on Reauth Required",this.sendSMSCode),type:"button"},this.translate("Resend SMS Code"))}else{button=React.createElement(FormButton,{disabled:!this.state.smsRequestsAllowed,isPrimary:false,onClick:this.recordClickEvent("Send SMS Code Button on Reauth Required",this.sendSMSCode),type:"button"},this.translate("Send SMS Code"))}return button},renderFailedValidationMsg:function renderFailedValidationMsg(){if(!this.props.twoStepAuthorization.codeValidationFailed()){return null}return React.createElement(FormInputValidation,{isError:true,text:this.translate("You entered an invalid code. Please try again.")})},renderSMSResendThrottled:function renderSMSResendThrottled(){if(!this.props.twoStepAuthorization.isSMSResendThrottled()){return null}return React.createElement("div",{className:"reauth-required__send-sms-throttled"},React.createElement(Notice,{showDismiss:false,text:this.translate("SMS codes are limited to once per minute. Please wait and try again.")}))},render:function render(){var codePlaceholder=this.props.twoStepAuthorization.isTwoStepSMSEnabled()?constants.sevenDigit2faPlaceholder:constants.sixDigit2faPlaceholder;return React.createElement(Dialog,{autoFocus:false,className:"reauth-required__dialog",isFullScreen:false,isVisible:this.props.twoStepAuthorization.isReauthRequired(),buttons:null,onClose:null},React.createElement("p",null,this.getCodeMessage()),React.createElement("p",null,React.createElement("a",{className:"reauth-required__sign-out",onClick:this.recordClickEvent("Reauth Required Log Out Link",userUtilities.logout)},this.translate("Not you? Sign Out"))),React.createElement("form",{onSubmit:this.submitForm},React.createElement(FormFieldset,null,React.createElement(FormLabel,{htmlFor:"code"},this.translate("Verification Code")),React.createElement(FormTelInput,{autoFocus:true,id:"code",isError:this.props.twoStepAuthorization.codeValidationFailed(),name:"code",placeholder:codePlaceholder,onFocus:this.recordFocusEvent("Reauth Required Verification Code Field"),ref:"code",valueLink:this.linkState("code")}),this.renderFailedValidationMsg()),React.createElement(FormFieldset,null,React.createElement(FormLabel,null,React.createElement(FormCheckbox,{checkedLink:this.linkState("remember2fa"),id:"remember2fa",name:"remember2fa",onClick:this.recordCheckboxEvent("Remember 2fa")}),React.createElement("span",null,this.translate("Remember for 30 days.")))),this.renderSMSResendThrottled(),React.createElement(FormButtonsBar,null,React.createElement(FormButton,{disabled:this.state.validatingCode||!this.preValidateAuthCode(),onClick:this.recordClickEvent("Submit Validation Code on Reauth Required")},this.translate("Verify")),this.renderSendSMSButton())))}})},1482:function(module,exports,__webpack_require__){"use strict";var debug=__webpack_require__(4)("calypso:user:profile-links"),reject=__webpack_require__(149),some=__webpack_require__(82);var wpcom=__webpack_require__(22),emitter=__webpack_require__(32);function UserProfileLinks(){if(!(this instanceof UserProfileLinks)){return new UserProfileLinks}this.profileLinks=false;this.initialized=false;this.reAuthRequired=false;this.fetchingProfileLinks=false}emitter(UserProfileLinks.prototype);UserProfileLinks.prototype.hasProfileLinks=function(){return!!this.profileLinks};UserProfileLinks.prototype.isSiteInProfileLinks=function(site){if(!this.initialized){return false}return some(this.profileLinks,function(profileLink){return site.domain===profileLink.value.replace(/^.*:\/\//,"")})};UserProfileLinks.prototype.getProfileLinks=function(){if(!this.profileLinks){this.fetchProfileLinks()}return this.profileLinks};UserProfileLinks.prototype.fetchProfileLinks=function(){if(this.fetchingProfileLinks){return}this.fetchingProfileLinks=true;debug("Fetching profile links for user");wpcom.me().settings().profileLinks().get(function(error,data){this.fetchingProfileLinks=false;if(error){debug("Something went wrong fetching the profile links for the user.");if("error"in error&&"reauthorization_required"===error.error){this.reAuthRequired=true}this.emit("change");return}this.profileLinks=data.profile_links;this.initialized=true;this.emit("change");debug("Profile links successfully retrieved")}.bind(this))};UserProfileLinks.prototype.addProfileLinks=function(profileLinks,callback){wpcom.me().settings().profileLinks().add(profileLinks,function(error,data){if(data&&data.profile_links){this.profileLinks=data.profile_links;this.emit("change")}callback(error,data)}.bind(this))};UserProfileLinks.prototype.deleteProfileLinkBySlug=function(slug,callback){wpcom.me().settings().profileLinks().del(slug,function(error,data){if(!error){this.profileLinks=reject(this.profileLinks,{link_slug:slug});this.emit("change")}callback(error,data)}.bind(this))};module.exports=new UserProfileLinks},1487:function(module,exports,__webpack_require__){"use strict";var _extends2=__webpack_require__(19);var _extends3=_interopRequireDefault(_extends2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var React=__webpack_require__(1),classnames=__webpack_require__(11),omit=__webpack_require__(18),classNames=__webpack_require__(11);module.exports=React.createClass({displayName:"FormTelInput",getDefaultProps:function getDefaultProps(){return{isError:false}},render:function render(){var otherProps=omit(this.props,["className","type"]),classes=classNames({"form-tel-input":true,"is-error":this.props.isError});return React.createElement("input",(0,_extends3.default)({},otherProps,{type:"tel",pattern:"[0-9]*",className:classnames(this.props.className,classes)}))}})},1491:function(module,exports,__webpack_require__){"use strict";var urls=__webpack_require__(62),assign=__webpack_require__(29),pick=__webpack_require__(72);module.exports=function(url){var bits,formatKeys=["host","hash","search","path"];if(null===url||""===url||"undefined"===typeof url){return null}bits=urls.parse(url);if(/^\/[^\/]/.test(url)){return url}if("http:"===bits.protocol||"https:"===bits.protocol){return url}return urls.format(assign(pick(bits,formatKeys),{protocol:"http"}))}},1492:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _i18nCalypso=__webpack_require__(13);var _i18nCalypso2=_interopRequireDefault(_i18nCalypso);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={sixDigit2faPlaceholder:_i18nCalypso2.default.translate("e.g. %(example)s",{args:{example:"123456"}}),sevenDigit2faPlaceholder:_i18nCalypso2.default.translate("e.g. %(example)s",{args:{example:"1234567"}}),eightDigitBackupCodePlaceholder:_i18nCalypso2.default.translate("e.g. %(example)s",{args:{example:"12345678"}})};module.exports=exports["default"]},1493:function(module,exports,__webpack_require__){"use strict";var _stringify=__webpack_require__(41);var _stringify2=_interopRequireDefault(_stringify);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var debug=__webpack_require__(4)("calypso:me:form-base");var notices=__webpack_require__(71);module.exports={componentDidMount:function componentDidMount(){this.props.userSettings.getSettings()},componentWillUnmount:function componentWillUnmount(){this.props.userSettings.unsavedSettings={}},getDisabledState:function getDisabledState(){return this.state.submittingForm},componentWillReceiveProps:function componentWillReceiveProps(nextProp){if(nextProp.showNoticeInitially){this.setState({showNotice:nextProp.showNoticeInitially})}},componentWillUpdate:function componentWillUpdate(){this.showNotice()},getInitialState:function getInitialState(){return{redirect:false,submittingForm:false,changingUsername:false,usernameAction:"new",showNotice:false}},showNotice:function showNotice(){if(this.props.userSettings.initialized&&this.state.showNotice){notices.clearNotices("notices");notices.success(this.translate("Settings saved successfully!"));this.state.showNotice=false}},valueLink:function valueLink(settingName){return{value:this.props.userSettings.getSetting(settingName),requestChange:function(value){this.props.userSettings.updateSetting(settingName,value)}.bind(this)}},submitForm:function submitForm(event){event.preventDefault();debug("Submitting form");this.setState({submittingForm:true});this.props.userSettings.saveSettings(function(error,response){this.setState({submittingForm:false});if(error){debug("Error saving settings: "+(0,_stringify2.default)(error));if(error.message){notices.error(error.message)}else{notices.error(this.translate("There was a problem saving your changes."))}}else{this.markSaved();if(this.state&&this.state.redirect){window.location=this.state.redirect+"?updated=success";return}this.setState({showNotice:true});this.showNotice();debug("Settings saved successfully "+(0,_stringify2.default)(response))}}.bind(this))}}},1503:function(module,exports,__webpack_require__){"use strict";var debug=__webpack_require__(4)("calypso:application-passwords-data"),makeEmitter=__webpack_require__(32),filter=__webpack_require__(69),store=__webpack_require__(42);var wpcom=__webpack_require__(22).undocumented();function ApplicationPasswords(){if(!(this instanceof ApplicationPasswords)){return new ApplicationPasswords}this.data=null;this.newApplicationPassword=null;this.fetching=false}makeEmitter(ApplicationPasswords.prototype);ApplicationPasswords.prototype.get=function(){if(!this.data){debug("First time loading ApplicationPasswords, check store");this.data=store.get("wpcom_me_application_passwords")||[];this.fetch()}return this.data};ApplicationPasswords.prototype.fetch=function(){this.fetching=true;wpcom.me().getApplicationPasswords(function(error,data){if(error){debug("Something went wrong fetching application passwords.");return}this.data=data.application_passwords;this.fetching=false;store.set("wpcom_me_application_passwords",this.data);debug("Application passwords successfully retrieved");this.emit("change")}.bind(this))};ApplicationPasswords.prototype.revoke=function(passwordID,callback){wpcom.me().revokeApplicationPassword(passwordID,function(error,data){if(!error||"unknown_application_password"===error.error){this.data=filter(this.data,function(password){return parseInt(password.ID,10)!==passwordID});store.set("wpcom_me_application_passwords",this.data);this.emit("change")}callback(error,data)}.bind(this))};ApplicationPasswords.prototype.create=function(applicationName,callback){wpcom.me().createApplicationPassword(applicationName,function(error,data){if(error){debug("Creating application password failed.")}else{debug("Application password successfully created");this.newApplicationPassword=data;this.fetch()}callback(error,data)}.bind(this))};ApplicationPasswords.prototype.hasNewPassword=function(){return!!this.newApplicationPassword};ApplicationPasswords.prototype.clearNewPassword=function(){this.newApplicationPassword=null;this.emit("change")};module.exports=new ApplicationPasswords},1504:function(module,exports,__webpack_require__){"use strict";var debug=__webpack_require__(4)("calypso:connected-applications-data"),Emitter=__webpack_require__(32),filter=__webpack_require__(69),find=__webpack_require__(33);var wpcom=__webpack_require__(22).undocumented();function ConnectedApplications(){if(!(this instanceof ConnectedApplications)){return new ConnectedApplications}this.data=[];this.initialized=false;this.fetching=false}Emitter(ConnectedApplications.prototype);ConnectedApplications.prototype.get=function(){if(!this.initialized){this.fetch()}return this.data};ConnectedApplications.prototype.fetch=function(){this.fetching=true;wpcom.me().getConnectedApplications(function(error,data){this.fetching=false;if(error){debug("Something went wrong fetching connected applications.");return}this.data=data.connected_applications;this.initialized=true;debug("Connected applications successfully retrieved");this.emit("change")}.bind(this))};ConnectedApplications.prototype.revoke=function(connectionID,callback){wpcom.me().revokeApplicationConnection(connectionID,function(error,data){if(error){debug("Revoking application connection failed.");callback(error);return}this.data=filter(this.data,function(connectedApp){return parseInt(connectedApp.ID,10)!==connectionID});callback(null,data);this.emit("change")}.bind(this))};ConnectedApplications.prototype.getApplication=function(connectionID){var application;if(!this.initialized){this.fetch();return}application=find(this.data,function(application){return parseInt(connectionID,10)===parseInt(application.ID,10)});if("undefined"===typeof application){this.fetch()}return application};module.exports=new ConnectedApplications},1507:function(module,exports,__webpack_require__){"use strict";var _extends2=__webpack_require__(19);var _extends3=_interopRequireDefault(_extends2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var React=__webpack_require__(1),classnames=__webpack_require__(11),omit=__webpack_require__(18),classNames=__webpack_require__(11);module.exports=React.createClass({displayName:"ActionRemove",getDefaultProps:function getDefaultProps(){return{isSubmitting:false,isPrimary:true}},render:function render(){var buttonClasses=classNames({"action-remove":true});return React.createElement("button",(0,_extends3.default)({title:this.translate("Remove",{textOnly:true})},omit(this.props,"className"),{className:classnames(this.props.className,buttonClasses)}),this.props.children)}})},1515:function(module,exports,__webpack_require__){"use strict";var debug=__webpack_require__(4)("calypso:trophies-data"),Emitter=__webpack_require__(32),store=__webpack_require__(42);var wpcom=__webpack_require__(22).undocumented();function TrophiesData(){if(!(this instanceof TrophiesData)){return new TrophiesData}this.initialized=false}Emitter(TrophiesData.prototype);TrophiesData.prototype.get=function(){var data;if(!this.data){data=store.get("TrophiesData");if(data){this.initialize(data)}else{this.data=[]}this.emit("change");this.fetch()}return this.data};TrophiesData.prototype.fetch=function(){wpcom.me().getTrophies(function(error,data){if(error){debug(error.error,error.message)}this.data=data;if(!this.initialized){this.initialized=true;this.emit("change")}store.set("TrophiesData",data)}.bind(this))};TrophiesData.prototype.initialize=function(TrophiesData){this.data=TrophiesData;this.initialized=true};TrophiesData.prototype.hasLoadedFromServer=function(){return this.initialized};module.exports=new TrophiesData},1516:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _reactDom=__webpack_require__(43);var _reactDom2=_interopRequireDefault(_reactDom);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _includes=__webpack_require__(34);var _includes2=_interopRequireDefault(_includes);var _page=__webpack_require__(40);var _page2=_interopRequireDefault(_page);var _i18nCalypso=__webpack_require__(13);var _i18nCalypso2=_interopRequireDefault(_i18nCalypso);var _analytics=__webpack_require__(16);var _analytics2=_interopRequireDefault(_analytics);var _route=__webpack_require__(122);var _route2=_interopRequireDefault(_route);var _userSettings=__webpack_require__(346);var _userSettings2=_interopRequireDefault(_userSettings);var _actions=__webpack_require__(648);var _reactHelpers=__webpack_require__(1458);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ANALYTICS_PAGE_TITLE="Me";exports.default={sidebar:function sidebar(context,next){var SidebarComponent=__webpack_require__(1528);(0,_reactHelpers.renderWithReduxStore)(_react2.default.createElement(SidebarComponent,{context:context}),document.getElementById("secondary"),context.store);next()},profile:function profile(context){var ProfileComponent=__webpack_require__(1527),basePath=context.path;context.store.dispatch((0,_actions.setDocumentHeadTitle)(_i18nCalypso2.default.translate("My Profile",{textOnly:true})));_analytics2.default.pageView.record(basePath,ANALYTICS_PAGE_TITLE+" > My Profile");(0,_reactHelpers.renderWithReduxStore)(_react2.default.createElement(ProfileComponent,{userSettings:_userSettings2.default,path:context.path}),document.getElementById("primary"),context.store)},apps:function apps(context){var AppsComponent=__webpack_require__(1517),basePath=context.path;context.store.dispatch((0,_actions.setDocumentHeadTitle)(_i18nCalypso2.default.translate("Get Apps",{textOnly:true})));_analytics2.default.pageView.record(basePath,ANALYTICS_PAGE_TITLE+" > Get Apps");(0,_reactHelpers.renderWithReduxStore)(_react2.default.createElement(AppsComponent,{userSettings:_userSettings2.default,path:context.path}),document.getElementById("primary"),context.store)},nextSteps:function nextSteps(context){var analyticsBasePath=_route2.default.sectionify(context.path),NextSteps=__webpack_require__(1518),trophiesData=__webpack_require__(1515),isWelcome="welcome"===context.params.welcome;context.store.dispatch((0,_actions.setDocumentHeadTitle)(_i18nCalypso2.default.translate("Next Steps",{textOnly:true})));if(isWelcome){_reactDom2.default.unmountComponentAtNode(document.getElementById("secondary"))}_analytics2.default.tracks.recordEvent("calypso_me_next_view",{is_welcome:isWelcome});_analytics2.default.pageView.record(analyticsBasePath,ANALYTICS_PAGE_TITLE+" > Next");(0,_reactHelpers.renderWithReduxStore)(_react2.default.createElement(NextSteps,{path:context.path,isWelcome:isWelcome,trophiesData:trophiesData}),document.getElementById("primary"),context.store)},nextStepsWelcomeRedirect:function nextStepsWelcomeRedirect(context,next){if((0,_includes2.default)(context.path,"?welcome")){return _page2.default.redirect("/me/next/welcome")}next()},profileRedirect:function profileRedirect(){_page2.default.redirect("/me")},trophiesRedirect:function trophiesRedirect(){_page2.default.redirect("/me")},findFriendsRedirect:function findFriendsRedirect(){_page2.default.redirect("/me")}};module.exports=exports["default"]},1517:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1);var MeSidebarNavigation=__webpack_require__(1454),Main=__webpack_require__(147),Button=__webpack_require__(68),Card=__webpack_require__(145);module.exports=React.createClass({displayName:"GetApps",render:function render(){return React.createElement(Main,{className:"get-apps"},React.createElement(MeSidebarNavigation,null),React.createElement("h1",{className:"get-apps__title"},this.translate("Get Apps")),React.createElement("p",{className:"get-apps__subheading"},this.translate("Manage all your WordPress.com and Jetpack-enabled sites in one place. On your desktop, or on the go.")),React.createElement("h2",{className:"form-section-heading"},this.translate("Desktop apps")),React.createElement(Card,{className:"get-apps__desktop"},React.createElement("section",{className:"get-apps__app"},React.createElement("div",{className:"get-apps__app-icon"},React.createElement("img",{src:"/calypso/images/me/get-apps-osx.svg",alt:this.translate("Mac"),width:"96",height:"96"})),React.createElement("p",null,React.createElement("strong",null,this.translate("Mac")),React.createElement("br",null),this.translate("Requires 10.11 or newer")),React.createElement(Button,{href:"https://apps.wordpress.com/d/osx?ref=getapps"},this.translate("Download"))),React.createElement("section",{className:"get-apps__app"},React.createElement("div",{className:"get-apps__app-icon"},React.createElement("img",{src:"/calypso/images/me/get-apps-windows.svg",alt:this.translate("Windows"),width:"96",height:"96"})),React.createElement("p",null,React.createElement("strong",null,this.translate("Windows")),React.createElement("br",null),this.translate("Requires 7 or newer")),React.createElement(Button,{href:"https://apps.wordpress.com/d/windows?ref=getapps"},this.translate("Download"))),React.createElement("section",{className:"get-apps__app"},React.createElement("div",{className:"get-apps__app-icon"},React.createElement("img",{src:"/calypso/images/me/get-apps-linux.svg",alt:this.translate("Linux"),width:"96",height:"96"})),React.createElement("p",null,React.createElement("strong",null,this.translate("Linux")),React.createElement("br",null),this.translate("Choose your distribution")),React.createElement(Button,{href:"https://apps.wordpress.com/d/linux?ref=getapps"},this.translate(".TAR.GZ"))," ",React.createElement(Button,{href:"https://apps.wordpress.com/d/linux-deb?ref=getapps"},this.translate(".DEB")))),React.createElement("h2",{className:"form-section-heading"},this.translate("Mobile apps")),React.createElement(Card,{className:"get-apps__mobile"},React.createElement("section",{className:"get-apps__app"},React.createElement("div",{className:"get-apps__app-icon"},React.createElement("img",{src:"/calypso/images/me/get-apps-ios.svg",alt:this.translate("iOS"),width:"96",height:"96"})),React.createElement("p",null,React.createElement("strong",null,this.translate("iOS"))),React.createElement("a",{href:"https://itunes.apple.com/us/app/wordpress/id335703880?mt=8"},React.createElement("img",{src:"/calypso/images/me/get-apps-app-store.png",alt:this.translate("Get on the iOS App Store")}))),React.createElement("section",{className:"get-apps__app"},React.createElement("div",{className:"get-apps__app-icon"},React.createElement("img",{src:"/calypso/images/me/get-apps-android.svg",alt:this.translate("Android"),width:"96",height:"96"})),React.createElement("p",null,React.createElement("strong",null,this.translate("Android"))),React.createElement("a",{href:"https://play.google.com/store/apps/details?id=org.wordpress.android"},React.createElement("img",{src:"/calypso/images/me/get-apps-google-play.png",alt:this.translate("Get on Google Play")})))))}})},1518:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),property=__webpack_require__(153),sortBy=__webpack_require__(124);var NextStepsBox=__webpack_require__(1519),MeSidebarNavigation=__webpack_require__(1454),observe=__webpack_require__(146),steps=__webpack_require__(1520),analytics=__webpack_require__(16),productsValues=__webpack_require__(80),sites=__webpack_require__(55)();module.exports=React.createClass({displayName:"exports",mixins:[observe("trophiesData","sites")],getDefaultProps:function getDefaultProps(){return{sites:sites}},userState:{},componentWillUnmount:function componentWillUnmount(){window.scrollTo(0,0)},recordEvent:function recordEvent(event){
analytics.ga.recordEvent("Me > Next > Welcome Message",event.action);analytics.tracks.recordEvent("calypso_me_next_welcome_click",{link:event.tracks,is_welcome:this.props.isWelcome})},setUserStateFromTrophiesData:function setUserStateFromTrophiesData(){this.userState={userHasPosted:this.hasUserPosted()}},hasUserPosted:function hasUserPosted(){if(this.props.trophiesData.hasLoadedFromServer()){return this.props.trophiesData.get().trophies.some(function(trophy){return"post-milestone"===trophy.type})}},renderPostComponent:function renderPostComponent(){if(this.props.trophiesData.hasLoadedFromServer()){return React.createElement("div",null,this.userState.userHasPosted?"You have posted":"Create a post")}},renderMeSidebar:function renderMeSidebar(){if(!this.props.isWelcome){return React.createElement(MeSidebarNavigation,null)}},bloggingUniversityLinkRecordEvent:function bloggingUniversityLinkRecordEvent(){this.recordEvent({tracks:"blogging_course",action:"Clicked Blogging University Link"})},docsLinkRecordEvent:function docsLinkRecordEvent(){this.recordEvent({tracks:"documentation",action:"Clicked Documentation Link"})},dismissLinkRecordEvent:function dismissLinkRecordEvent(){this.recordEvent({tracks:"dismiss",action:"Clicked Dismiss Link"})},introMessage:function introMessage(){if(this.props.isWelcome){return React.createElement("div",{className:"next-steps__intro"},React.createElement("h3",{className:"next-steps__title"},this.translate("Thanks for signing up for WordPress.com.")),React.createElement("p",{className:"next-steps__intro"},this.translate("Next you can take any of the following steps, "+"join a {{bloggingUniversityLink}}guided blogging course{{/bloggingUniversityLink}}, "+"or check out our {{docsLink}}support documentation{{/docsLink}}.",{components:{bloggingUniversityLink:React.createElement("a",{href:"https://bloggingu.wordpress.com/",target:"_blank",onClick:this.bloggingUniversityLinkRecordEvent}),docsLink:React.createElement("a",{href:"http://en.support.wordpress.com/",target:"_blank",onClick:this.docsLinkRecordEvent})}})))}},newestSite:function newestSite(){return sortBy(this.props.sites.get(),property("ID")).pop()},outroMessage:function outroMessage(){var site,dismissLink;if(this.props.isWelcome){site=this.newestSite();dismissLink="/stats/insights/"+(site?site.slug:"");return React.createElement("div",{className:"next-steps__outro"},React.createElement("p",null,this.translate("If you want you can {{a}}skip these steps{{/a}}. You can come back to this page any time.",{components:{a:React.createElement("a",{href:dismissLink,onClick:this.dismissLinkRecordEvent})}})))}},userHasPurchasedAPlan:function userHasPurchasedAPlan(){return this.props.sites.get().some(function(site){return productsValues.isPlan(site.plan)})},renderSteps:function renderSteps(){var site=this.newestSite(),sequence=steps.defaultSequence;if(this.userHasPurchasedAPlan()){sequence=steps.hasPlanSequence}return React.createElement("div",{className:"next-steps__steps"},sequence.map(function(stepName,index){var step=steps.definitions(site)[stepName];return React.createElement(NextStepsBox,{key:stepName,stepName:stepName,step:step,primary:index===0,isWelcome:this.props.isWelcome})}.bind(this)))},render:function render(){var classes="main main-column next-steps";this.setUserStateFromTrophiesData();if(this.props.isWelcome){classes+=" is-single-page"}return React.createElement("div",{className:classes},this.renderMeSidebar(),this.introMessage(),this.renderSteps(),this.outroMessage())}})},1519:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1);var analytics=__webpack_require__(16);module.exports=React.createClass({displayName:"exports",recordEvent:function recordEvent(){analytics.ga.recordEvent("Me > Next > Box",this.props.stepName);analytics.tracks.recordEvent("calypso_me_next_click",{module:this.props.stepName,is_welcome:this.props.isWelcome})},render:function render(){var boxClassNames="next-steps-box",bodyClassNames="next-steps-box__step-body",buttonClassNames="button";if(this.props.primary){boxClassNames+=" is-primary";bodyClassNames+=" is-primary";buttonClassNames+=" is-primary"}return React.createElement("div",{className:boxClassNames},React.createElement("div",{className:"next-steps-box__step-header"},React.createElement("h2",null,this.props.step.title)),React.createElement("div",{className:bodyClassNames},this.props.step.body,React.createElement("div",{className:"next-steps-box__step-action"},React.createElement("a",{className:buttonClassNames,href:this.props.step.buttonURL,onClick:this.recordEvent},this.props.step.buttonText))))}})},1520:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),i18n=__webpack_require__(13);var paths=__webpack_require__(356),config=__webpack_require__(10);function buildCustomizeButtonURL(site){if(site){return site.jetpack?site.options.admin_url+"customize.php":"/customize/"+site.slug}return"/customize/"}module.exports={defaultSequence:["customize","theme","plans","post","page"],hasPlanSequence:["customize","theme","post","page","follow"],userOnly:["site","profile","follow"],definitions:function definitions(site){return{post:{title:i18n.translate("Start Your First Post"),body:i18n.translate("{{p1}}Start blogging right away by writing your first post.{{/p1}}{{p2}}You can create new posts by clicking the {{pencil}}{{/pencil}} at the top of the screen.{{/p2}}",{comment:"p1 and p2 are paragraph tags.",components:{p1:React.createElement("p",null),p2:React.createElement("p",null),pencil:React.createElement("span",{className:"noticon noticon-edit"})}}),buttonText:i18n.translate("Start a Post"),buttonURL:paths.newPost(site)},theme:{title:i18n.translate("Select a Theme"),body:i18n.translate("{{p1}}The theme is the look and feel of your WordPress. A theme doesn't change your content, just the way it is presented.{{/p1}}{{p2}}Choose a theme based on your taste. You can always change it later.{{/p2}}",{comment:"p1 and p2 are paragraph tags.",components:{p1:React.createElement("p",null),p2:React.createElement("p",null)}}),buttonText:i18n.translate("Select a Theme"),buttonURL:"/design/"+(site?site.slug:"")},customize:{title:i18n.translate("Customize Your Site"),body:i18n.translate("{{p1}}You can use the Customizer to add header and background images, or tweak your theme.  {{/p1}}{{p2}}You can find the Customizer in My Sites.{{/p2}}",{comment:"p1 and p2 are paragraph tags.",components:{p1:React.createElement("p",null),p2:React.createElement("p",null)}}),buttonText:i18n.translate("Customize Your Site"),buttonURL:buildCustomizeButtonURL(site)},plans:{title:i18n.translate("Add Features with a Plan"),body:i18n.translate("{{p1}}Plans upgrade your WordPress with storage, design options, and a custom domain.{{/p1}}{{p2}}A plan will also remove ads and enable audio and video uploads.{{/p2}}",{comment:"p1 and p2 are paragraph tags",components:{p1:React.createElement("p",null),p2:React.createElement("p",null)}}),buttonText:i18n.translate("Add a Plan"),buttonURL:"/plans/"+(site?site.slug:"")},page:{title:i18n.translate("Create a Page"),body:i18n.translate("{{p1}}Pages are sections of your site that contain information for your visitors.{{/p1}}{{p2}}Think about creating an About or Contact Us page to get started.{{/p2}}",{comment:"p1 and p2 are paragraph tags.",components:{p1:React.createElement("p",null),p2:React.createElement("p",null)}}),buttonText:i18n.translate("Create a Page"),buttonURL:paths.newPage(site)},site:{title:i18n.translate("Create a Site"),body:i18n.translate("{{p1}}Start a new WordPress site or blog.{{/p1}}{{p2}}Your own WordPress is free and a great way to create a home on the web.{{/p2}}",{comment:"p1 and p2 are paragraph tags.",components:{p1:React.createElement("p",null),p2:React.createElement("p",null)}}),buttonText:i18n.translate("Create a Site"),buttonURL:config("signup_url")},profile:{title:i18n.translate("Complete Your Profile"),body:i18n.translate("{{p1}}Your profile is how other users see you.{{/p1}}{{p2}}Share a blurb about yourself to let others know what you're all about.{{/p2}}",{comment:"p1 and p2 are paragraph tags.",components:{p1:React.createElement("p",null),p2:React.createElement("p",null)}}),buttonText:i18n.translate("Complete Your Profile"),buttonURL:"/me"},follow:{title:i18n.translate("Follow Some Blogs"),body:i18n.translate("{{p1}}Follow some other sites to stay informed and find inspiration.{{/p1}}{{p2}}All of the content you follow shows up in your Reader.{{/p2}}",{comment:"p1 and p2 are paragraph tags.",components:{p1:React.createElement("p",null),p2:React.createElement("p",null)}}),buttonText:i18n.translate("Follow Some Blogs"),buttonURL:"/recommendations/"}}}}},1521:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),debug=__webpack_require__(4)("calypso:me:sidebar-gravatar");var Gravatar=__webpack_require__(647),eventRecorder=__webpack_require__(644);module.exports=React.createClass({displayName:"ProfileGravatar",mixins:[eventRecorder],componentDidMount:function componentDidMount(){debug("The ProfileGravatar component is mounted.")},render:function render(){var profileURL="//gravatar.com/"+this.props.user.username;return React.createElement("div",{className:"profile-gravatar"},React.createElement("a",{href:"https://secure.gravatar.com/site/wpcom?wpcc-no-close",target:"_blank",className:"profile-gravatar__edit",onClick:this.recordClickEvent("Gravatar Update Profile Photo in Sidebar")},React.createElement(Gravatar,{user:this.props.user,size:150,imgSize:400}),React.createElement("span",{className:"profile-gravatar__edit-label-wrap"},React.createElement("span",{className:"profile-gravatar__edit-label"},this.translate("Update Profile Photo")))),React.createElement("h2",{className:"profile-gravatar__user-display-name"},this.props.user.display_name),React.createElement("div",{className:"profile-gravatar__user-secondary-info"},React.createElement("a",{href:profileURL,target:"_blank"},"@",this.props.user.username)))}})},1522:function(module,exports,__webpack_require__){"use strict";var _url=__webpack_require__(109);var React=__webpack_require__(1),classNames=__webpack_require__(11);var ActionRemove=__webpack_require__(1507),safeProtocolUrl=__webpack_require__(1491),eventRecorder=__webpack_require__(644);module.exports=React.createClass({displayName:"ProfileLink",mixins:[eventRecorder],getDefaultProps:function getDefaultProps(){return{imageSize:100,title:"",url:"",slug:"",isPlaceholder:false}},propTypes:{imageSize:React.PropTypes.number,title:React.PropTypes.string.isRequired,url:React.PropTypes.string.isRequired,slug:React.PropTypes.string.isRequired},renderRemove:function renderRemove(){return React.createElement(ActionRemove,{className:"profile-link__remove",onClick:this.recordClickEvent("Remove Link Next to Site",this.props.onRemoveLink)})},render:function render(){var classes=classNames({"profile-link":true,"is-placeholder":this.props.isPlaceholder}),imageSrc="//s1.wp.com/mshots/v1/"+encodeURIComponent(this.props.url)+"?w="+this.props.imageSize+"&h=64",linkHref=this.props.isPlaceholder?null:safeProtocolUrl(this.props.url);return React.createElement("li",{className:classes},this.props.isPlaceholder?React.createElement("div",{className:"profile-link__image-link"}):React.createElement("a",{href:linkHref,className:"profile-link__image-link",target:"_blank",onClick:this.recordClickEvent("Profile Links Site Images Link")},React.createElement("img",{className:"profile-link__image",src:imageSrc})),React.createElement("a",{href:linkHref,target:"_blank",onClick:this.recordClickEvent("Profile Links Site Link")},React.createElement("span",{className:"profile-link__title"},this.props.title),React.createElement("span",{className:"profile-link__url"},(0,_url.withoutHttp)(this.props.url))),this.props.isPlaceholder?null:this.renderRemove())}})},1523:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),LinkedStateMixin=__webpack_require__(340);var FormFieldset=__webpack_require__(338),FormTextInput=__webpack_require__(246),FormButton=__webpack_require__(337),eventRecorder=__webpack_require__(644),Notice=__webpack_require__(79);module.exports=React.createClass({displayName:"ProfileLinksAddOther",mixins:[LinkedStateMixin,eventRecorder],getInitialState:function getInitialState(){return{title:"",value:"",lastError:false}},getFormDisabled:function getFormDisabled(){var trimmedValue=this.state.value.trim();if(!this.state.title.trim()||!trimmedValue){return true}if(-1!==trimmedValue.indexOf(" ")){return true}if(!trimmedValue.match(/[a-zA-z0-9]+\.[a-zA-z]{2,}/)){return true}if(trimmedValue.match(/^.*:\/\//)&&!trimmedValue.match(/^https?:\/\//)){return true}return false},onSubmit:function onSubmit(event){event.preventDefault();if(this.getFormDisabled()){return}this.props.userProfileLinks.addProfileLinks([{title:this.state.title.trim(),value:this.state.value.trim()}],this.onSubmitResponse)},onCancel:function onCancel(event){event.preventDefault();this.props.onCancel()},onSubmitResponse:function onSubmitResponse(error,data){if(error){this.setState({lastError:this.translate("Unable to add link right now. Please try again later.")})}else if(data.duplicate){this.setState({lastError:this.translate("That link is already in your profile links. No changes were made.")})}else if(data.malformed){this.setState({lastError:this.translate("An unexpected error occurred. Please try again later.")})}else{this.props.onSuccess()}},clearLastError:function clearLastError(){this.setState({lastError:false})},possiblyRenderError:function possiblyRenderError(){if(!this.state.lastError){return null}return React.createElement(Notice,{className:"profile-links-add-other__error",status:"is-error",onDismissClick:this.clearLastError,text:this.state.lastError})},render:function render(){return React.createElement("form",{className:"profile-links-add-other",onSubmit:this.onSubmit},React.createElement("p",null,this.translate("Please enter the URL and description of the site you want to add to your profile.")),this.possiblyRenderError(),React.createElement(FormFieldset,null,React.createElement(FormTextInput,{className:"profile-links-add-other__value",valueLink:this.linkState("value"),placeholder:this.translate("Enter a URL"),onFocus:this.recordFocusEvent("Add Other Site URL Field")}),React.createElement(FormTextInput,{className:"profile-links-add-other__title",valueLink:this.linkState("title"),placeholder:this.translate("Enter a description"),onFocus:this.recordFocusEvent("Add Other Site Description Field")}),React.createElement(FormButton,{className:"profile-links-add-other__add",disabled:this.getFormDisabled(),onClick:this.recordClickEvent("Save Other Site Button")},this.translate("Add Site")),React.createElement(FormButton,{className:"profile-links-add-other__cancel",isPrimary:false,onClick:this.recordClickEvent("Cancel Other Site Button",this.onCancel)},this.translate("Cancel"))))}})},1524:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1);var config=__webpack_require__(10),FormButton=__webpack_require__(337),Notice=__webpack_require__(79),Site=__webpack_require__(344),sites=__webpack_require__(55)(),eventRecorder=__webpack_require__(644);module.exports=React.createClass({displayName:"ProfileLinksAddWordPress",mixins:[eventRecorder],getInitialState:function getInitialState(){return{}},handleCheckedChanged:function handleCheckedChanged(event){var updates={};updates[event.target.name]=event.target.checked;this.setState(updates)},onSelect:function onSelect(inputName,event){var updates={};event.preventDefault();updates[inputName]=!this.state[inputName];this.setState(updates)},getCheckedCount:function getCheckedCount(){var inputName;var checkedCount=0;for(inputName in this.state){if(this.state[inputName]){checkedCount++}}return checkedCount},onAddableSubmit:function onAddableSubmit(event){var links=[];var inputName,siteID,site;event.preventDefault();for(inputName in this.state){if("site-"===inputName.substr(0,5)&&this.state[inputName]){siteID=parseInt(inputName.substr(5),10);site=sites.getSite(siteID);links.push({title:site.name,value:site.URL})}}this.props.userProfileLinks.addProfileLinks(links,this.onSubmitResponse)},onCancel:function onCancel(event){event.preventDefault();this.props.onCancel()},onCreateSite:function onCreateSite(event){event.preventDefault();window.open(config("signup_url")+"?ref=me-profile-links");this.props.onCancel()},onJetpackMe:function onJetpackMe(event){event.preventDefault();window.open("http://jetpack.me/");this.props.onCancel()},onSubmitResponse:function onSubmitResponse(error,data){if(error){this.setState({lastError:this.translate("Unable to add any links right now. Please try again later.")});return}else if(data.malformed){this.setState({lastError:this.translate("An unexpected error occurred. Please try again later.")});return}else if(data.duplicate){this.props.userProfileLinks.fetchProfileLinks()}this.props.onSuccess()},clearLastError:function clearLastError(){this.setState({lastError:false})},possiblyRenderError:function possiblyRenderError(){if(!this.state.lastError){return null}return React.createElement(Notice,{className:"profile-links-add-wordpress__error",status:"is-error",onDismissClick:this.clearLastError},this.state.lastError)},renderAddableSites:function renderAddableSites(){return sites.getPublic().map(function(site){var inputName,checkedState;if(this.props.userProfileLinks.isSiteInProfileLinks(site)){return null}inputName="site-"+site.ID;checkedState=this.state[inputName];return React.createElement("li",{key:site.ID,className:"profile-links-add-wordpress__item",onClick:this.recordCheckboxEvent("Add WordPress Site")},React.createElement("input",{className:"profile-links-add-wordpress__checkbox",type:"checkbox",name:inputName,onChange:this.handleCheckedChanged,checked:checkedState}),React.createElement(Site,{site:site,indicator:false,onSelect:this.onSelect.bind(this,inputName)}))}.bind(this))},renderAddableSitesForm:function renderAddableSitesForm(){var checkedCount=this.getCheckedCount();return React.createElement("form",{className:"profile-links-add-wordpress",onSubmit:this.onAddableSubmit},React.createElement("p",null,this.translate("Please select one or more sites to add to your profile.")),React.createElement("ul",{className:"profile-links-add-wordpress__list"},this.renderAddableSites()),this.possiblyRenderError(),React.createElement(FormButton,{disabled:0===checkedCount?true:false,onClick:this.recordClickEvent("Add WordPress Sites Button")},this.translate("Add Site","Add Sites",{count:checkedCount})),React.createElement(FormButton,{className:"profile-links-add-wordpress__cancel",isPrimary:false,onClick:this.recordClickEvent("Cancel Add WordPress Sites Button",this.onCancel)},this.translate("Cancel")))},renderInvitationForm:function renderInvitationForm(){return React.createElement("form",null,React.createElement("p",null,this.translate("You have no public sites on WordPress.com yet, but if you like you "+"can create one now.  You may also add self-hosted WordPress "+"sites here after installing {{jetpackLink}}Jetpack{{/jetpackLink}} on them.",{components:{jetpackLink:React.createElement("a",{href:"#",className:"profile-links-add-wordpress__jetpack-link",onClick:this.recordClickEvent("Jetpack Link in Profile Links",this.onJetpackMe)})}})),React.createElement(FormButton,{onClick:this.recordClickEvent("Create Sites Button in Profile Links",this.onCreateSite)},this.translate("Create Site")),React.createElement(FormButton,{className:"profile-links-add-wordpress__cancel",isPrimary:false,onClick:this.recordClickEvent("Cancel Add WordPress Sites Button",this.onCancel)},this.translate("Cancel")))},render:function render(){return React.createElement("div",null,0===sites.getPublic().length?this.renderInvitationForm():this.renderAddableSitesForm())}})},1525:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _button=__webpack_require__(68);var _button2=_interopRequireDefault(_button);var _dataObserve=__webpack_require__(146);var _dataObserve2=_interopRequireDefault(_dataObserve);var _eventRecorder=__webpack_require__(644);var _eventRecorder2=_interopRequireDefault(_eventRecorder);var _gridicon=__webpack_require__(28);var _gridicon2=_interopRequireDefault(_gridicon);var _menu=__webpack_require__(1481);var _menu2=_interopRequireDefault(_menu);var _menuItem=__webpack_require__(1462);var _menuItem2=_interopRequireDefault(_menuItem);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"AddProfileLinksButtons",mixins:[(0,_dataObserve2.default)("userProfileLinks"),_eventRecorder2.default],propTypes:{showingForm:_react2.default.PropTypes.bool,showPopoverMenu:_react2.default.PropTypes.bool},getDefaultProps:function getDefaultProps(){return{showingForm:false}},getInitialState:function getInitialState(){return{popoverPosition:"top"}},render:function render(){return _react2.default.createElement("div",null,_react2.default.createElement(_menu2.default,{isVisible:this.props.showPopoverMenu,onClose:this.props.onClosePopoverMenu,position:this.state.popoverPosition,context:this.refs&&this.refs.popoverMenuButton},_react2.default.createElement(_menuItem2.default,{onClick:this.recordClickEvent("Add a WordPress Site Button",this.props.onShowAddWordPress)},this.translate("Add WordPress Site")),_react2.default.createElement(_menuItem2.default,{onClick:this.recordClickEvent("Add Other Site Button",this.props.onShowAddOther)},this.translate("Add URL"))),_react2.default.createElement(_button2.default,{compact:true,ref:"popoverMenuButton",className:"popover-icon",onClick:this.props.onShowPopoverMenu},_react2.default.createElement(_gridicon2.default,{icon:"add-outline"}),this.translate("Add")))}});module.exports=exports["default"]},1526:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),times=__webpack_require__(653);var ProfileLink=__webpack_require__(1522),observe=__webpack_require__(146),AddProfileLinksButtons=__webpack_require__(1525),SectionHeader=__webpack_require__(1451),Card=__webpack_require__(145),Notice=__webpack_require__(79),eventRecorder=__webpack_require__(644),ProfileLinksAddWordPress=__webpack_require__(1524),ProfileLinksAddOther=__webpack_require__(1523);module.exports=React.createClass({displayName:"ProfileLinks",mixins:[observe("userProfileLinks"),eventRecorder],componentDidMount:function componentDidMount(){this.props.userProfileLinks.getProfileLinks();if(typeof document.hidden!=="undefined"){document.addEventListener("visibilitychange",this.handleVisibilityChange)}},componentWillUnmount:function componentWillUnmount(){if(typeof document.hidden!=="undefined"){document.removeEventListener("visibilitychange",this.handleVisibilityChange)}},handleVisibilityChange:function handleVisibilityChange(){if(!document.hidden){this.props.userProfileLinks.fetchProfileLinks()}},getDefaultProps:function getDefaultProps(){return{userProfileLinks:{initialized:false}}},getInitialState:function getInitialState(){return{showingForm:false,lastError:false,showPopoverMenu:false}},showAddWordPress:function showAddWordPress(){this.setState({showingForm:"wordpress",showPopoverMenu:false})},showAddOther:function showAddOther(){this.setState({showingForm:"other",showPopoverMenu:false})},showPopoverMenu:function showPopoverMenu(){this.setState({showPopoverMenu:!this.state.showPopoverMenu})},closePopoverMenu:function closePopoverMenu(){this.setState({showPopoverMenu:false})},hideForms:function hideForms(){this.setState({showingForm:false})},onRemoveLinkResponse:function onRemoveLinkResponse(error){if(error){this.setState({lastError:error})}else{this.setState({lastError:false})}},clearLastError:function clearLastError(){this.setState({lastError:false})},onRemoveLink:function onRemoveLink(profileLink){this.props.userProfileLinks.deleteProfileLinkBySlug(profileLink.link_slug,this.onRemoveLinkResponse)},possiblyRenderError:function possiblyRenderError(){if(!this.state.lastError){return null}return React.createElement(Notice,{className:"profile-links__error",status:"is-error",onDismissClick:this.clearLastError},this.translate("An error occurred while attempting to remove the link. Please try again later."))},renderProfileLinksList:function renderProfileLinksList(){return React.createElement("ul",{className:"profile-links__list"},this.props.userProfileLinks.getProfileLinks().map(function(profileLink){return React.createElement(ProfileLink,{key:profileLink.link_slug,title:profileLink.title,url:profileLink.value,slug:profileLink.link_slug,onRemoveLink:this.onRemoveLink.bind(this,profileLink)})},this))},renderNoProfileLinks:function renderNoProfileLinks(){return React.createElement("p",{className:"profile-links__no-links"},this.translate("You have no sites in your profile links. You may add sites if you'd like."))},renderPlaceholders:function renderPlaceholders(){return React.createElement("ul",{className:"profile-links__list"},times(2,function(index){return React.createElement(ProfileLink,{title:"Loading Profile Links",url:"http://wordpress.com",slug:"A placeholder profile link",isPlaceholder:true,key:index})}))},renderProfileLinks:function renderProfileLinks(){var links=void 0,initialized=this.props.userProfileLinks.initialized,countLinks=this.props.userProfileLinks.getProfileLinks().length;if(!initialized){links=this.renderPlaceholders()}else{links=countLinks>0?this.renderProfileLinksList():this.renderNoProfileLinks()}return React.createElement("div",null,React.createElement("p",null,this.translate("Manage which sites appear in your profile.")),this.possiblyRenderError(),links)},renderForm:function renderForm(){if("wordpress"===this.state.showingForm){return React.createElement(ProfileLinksAddWordPress,{userProfileLinks:this.props.userProfileLinks,onSuccess:this.hideForms,onCancel:this.hideForms})}return React.createElement(ProfileLinksAddOther,{userProfileLinks:this.props.userProfileLinks,onSuccess:this.hideForms,onCancel:this.hideForms})},render:function render(){return React.createElement("div",null,React.createElement(SectionHeader,{label:this.translate("Profile Links")},React.createElement(AddProfileLinksButtons,{userProfileLinks:this.props.userProfileLinks,showingForm:!!this.state.showingForm,onShowAddOther:this.showAddOther,showPopoverMenu:this.state.showPopoverMenu,onShowAddWordPress:this.showAddWordPress,onShowPopoverMenu:this.showPopoverMenu,onClosePopoverMenu:this.closePopoverMenu})),React.createElement(Card,null,!!this.state.showingForm?this.renderForm():this.renderProfileLinks()))}})},1527:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),LinkedStateMixin=__webpack_require__(340),debug=__webpack_require__(4)("calypso:me:profile");var MeSidebarNavigation=__webpack_require__(1454),protectForm=__webpack_require__(650),formBase=__webpack_require__(1493),FormButton=__webpack_require__(337),FormFieldset=__webpack_require__(338),FormLabel=__webpack_require__(645),FormTextInput=__webpack_require__(246),FormTextarea=__webpack_require__(1480),ProfileLinks=__webpack_require__(1526),userProfileLinks=__webpack_require__(1482),ReauthRequired=__webpack_require__(1476),twoStepAuthorization=__webpack_require__(1464),Card=__webpack_require__(145),observe=__webpack_require__(146),eventRecorder=__webpack_require__(644),Main=__webpack_require__(147);module.exports=React.createClass({displayName:"Profile",mixins:[formBase,LinkedStateMixin,protectForm.mixin,observe("userSettings"),eventRecorder],componentDidMount:function componentDidMount(){debug(this.constructor.displayName+" component is mounted.")},componentWillUnmount:function componentWillUnmount(){debug(this.constructor.displayName+" component is unmounting.")},render:function render(){var gravatarProfileLink="https://gravatar.com/"+this.props.userSettings.getSetting("user_login");return React.createElement(Main,{className:"profile"},React.createElement(MeSidebarNavigation,null),React.createElement(ReauthRequired,{twoStepAuthorization:twoStepAuthorization}),React.createElement(Card,{className:"me-profile-settings"},React.createElement("p",null,this.translate("This information will be displayed publicly on {{profilelink}}your profile{{/profilelink}} and in "+"{{hovercardslink}}Gravatar Hovercards{{/hovercardslink}}.",{components:{profilelink:React.createElement("a",{onClick:this.recordClickEvent("My Profile Link"),href:gravatarProfileLink,target:"_blank"}),hovercardslink:React.createElement("a",{onClick:this.recordClickEvent("Gravatar Hovercards Link"),href:"https://support.wordpress.com/gravatar-hovercards/",target:"_blank"})}})),React.createElement("form",{onSubmit:this.submitForm,onChange:this.markChanged},React.createElement(FormFieldset,null,React.createElement(FormLabel,{htmlFor:"first_name"},this.translate("First Name")),React.createElement(FormTextInput,{disabled:this.getDisabledState(),id:"first_name",name:"first_name",onFocus:this.recordFocusEvent("First Name Field"),valueLink:this.valueLink("first_name")})),React.createElement(FormFieldset,null,React.createElement(FormLabel,{htmlFor:"last_name"},this.translate("Last Name")),React.createElement(FormTextInput,{disabled:this.getDisabledState(),id:"last_name",name:"last_name",onFocus:this.recordFocusEvent("Last Name Field"),valueLink:this.valueLink("last_name")})),React.createElement(FormFieldset,null,React.createElement(FormLabel,{htmlFor:"display_name"},this.translate("Public Display Name")),React.createElement(FormTextInput,{disabled:this.getDisabledState(),id:"display_name",name:"display_name",onFocus:this.recordFocusEvent("Display Name Field"),valueLink:this.valueLink("display_name")})),React.createElement(FormFieldset,null,React.createElement(FormLabel,{htmlFor:"description"},this.translate("About Me")),React.createElement(FormTextarea,{disabled:this.getDisabledState(),id:"description",name:"description",onFocus:this.recordFocusEvent("About Me Field"),valueLink:this.valueLink("description")})),React.createElement("p",null,React.createElement(FormButton,{disabled:!this.props.userSettings.hasUnsavedSettings()||this.getDisabledState(),onClick:this.recordClickEvent("Save Profile Details Button")},this.state.submittingForm?this.translate("Saving"):this.translate("Save Profile Details"))))),React.createElement(ProfileLinks,{userProfileLinks:userProfileLinks}))}})},1528:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _debug=__webpack_require__(4);var _debug2=_interopRequireDefault(_debug);var _reactRedux=__webpack_require__(21);var _actions=__webpack_require__(95);var _selectors=__webpack_require__(121);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var debug=(0,_debug2.default)("calypso:me:sidebar");var Sidebar=__webpack_require__(675),SidebarHeading=__webpack_require__(674),SidebarItem=__webpack_require__(362),SidebarMenu=__webpack_require__(676),config=__webpack_require__(10),ProfileGravatar=__webpack_require__(1521),eventRecorder=__webpack_require__(644),FormButton=__webpack_require__(337),userUtilities=__webpack_require__(150);var MeSidebar=_react2.default.createClass({displayName:"MeSidebar",mixins:[eventRecorder],componentDidMount:function componentDidMount(){debug("The MeSidebar React component is mounted.")},onNavigate:function onNavigate(){this.props.setNextLayoutFocus("content");window.scrollTo(0,0)},onSignOut:function onSignOut(){var currentUser=this.props.currentUser;var isEnLocale=currentUser&&currentUser.localeSlug==="en";var redirect=null;if(isEnLocale&&!config.isEnabled("desktop")){redirect="/?apppromo"}userUtilities.logout(redirect);this.recordClickEvent("Sidebar Sign Out Link");
},render:function render(){var context=this.props.context;var filterMap={"/me":"profile","/me/security/two-step":"security","/me/security/connected-applications":"security","/me/security/checkup":"security","/me/notifications/comments":"notifications","/me/notifications/updates":"notifications","/me/notifications/subscriptions":"notifications","/help/contact":"help","/purchases":"billing","/me/billing":"billing"};var filteredPath=context.path.replace(/\/\d+$/,"");var selected=void 0;if(filterMap[filteredPath]){selected=filterMap[filteredPath]}else{selected=context.path.split("/").pop()}return _react2.default.createElement(Sidebar,null,_react2.default.createElement(ProfileGravatar,{user:this.props.currentUser}),_react2.default.createElement("div",{className:"me-sidebar__signout"},_react2.default.createElement(FormButton,{className:"me-sidebar__signout-button",isPrimary:false,onClick:this.onSignOut,title:this.translate("Sign out of WordPress.com",{textOnly:true})},this.translate("Sign Out"))),_react2.default.createElement(SidebarMenu,null,_react2.default.createElement(SidebarHeading,null,this.translate("Profile")),_react2.default.createElement("ul",null,_react2.default.createElement(SidebarItem,{selected:selected==="profile",link:config.isEnabled("me/my-profile")?"/me":"//wordpress.com/me/public-profile",label:this.translate("My Profile"),icon:"user",onNavigate:this.onNavigate}),_react2.default.createElement(SidebarItem,{selected:selected==="account",link:config.isEnabled("me/account")?"/me/account":"//wordpress.com/me/account",label:this.translate("Account Settings"),icon:"cog",onNavigate:this.onNavigate,preloadSectionName:"account"}),_react2.default.createElement(SidebarItem,{selected:selected==="billing",link:"/purchases",label:this.translate("Manage Purchases"),icon:"credit-card",onNavigate:this.onNavigate,preloadSectionName:"purchases"}),_react2.default.createElement(SidebarItem,{selected:selected==="security",link:config.isEnabled("me/security")?"/me/security":"//wordpress.com/me/security",label:this.translate("Security"),icon:"lock",onNavigate:this.onNavigate,preloadSectionName:"security"}),_react2.default.createElement(SidebarItem,{selected:selected==="notifications",link:config.isEnabled("me/notifications")?"/me/notifications":"//wordpress.com/me/notifications",label:this.translate("Notifications"),icon:"bell",onNavigate:this.onNavigate,preloadSectionName:"notification-settings"}))),_react2.default.createElement(SidebarMenu,null,_react2.default.createElement(SidebarHeading,null,this.translate("Special")),_react2.default.createElement("ul",null,_react2.default.createElement(SidebarItem,{selected:selected==="get-apps",link:"/me/get-apps",label:this.translate("Get Apps"),icon:"my-sites",onNavigate:this.onNavigate}),this.renderNextStepsItem(selected),_react2.default.createElement(SidebarItem,{selected:selected==="help",link:config.isEnabled("help")?"/help":"//support.wordpress.com",label:this.translate("Help"),external:config.isEnabled("help")?"false":"true",icon:"help-outline",onNavigate:this.onNavigate,preloadSectionName:"help"}))))},renderNextStepsItem:function renderNextStepsItem(selected){var currentUser=this.props.currentUser;if(config.isEnabled("me/next-steps")&&currentUser&&currentUser.site_count>0){return _react2.default.createElement(SidebarItem,{selected:selected==="next",link:"/me/next",label:this.translate("Next Steps"),icon:"list-checkmark",onNavigate:this.onNavigate})}}});function mapStateToProps(state){return{currentUser:(0,_selectors.getCurrentUser)(state)}}exports.default=(0,_reactRedux.connect)(mapStateToProps,{setNextLayoutFocus:_actions.setNextLayoutFocus})(MeSidebar);module.exports=exports["default"]}});